# obsidian-workflowy-plugin

## v1.0：
大纲视图用法（右上角更多菜单切换视图）：

1、顶部导航栏，聚焦后可以点击切节点，搜索栏搜索内容高亮节点，主题12个

2、基本格式：4个空格为一个tab缩进，如果不是四个就不渲染，要求是 - 开头，类似logseq那种md格式

3、点击操作：

- 左侧垂直线可以折叠展开节点
- 点击圆圈进入聚焦模式
- 节点按住鼠标左键，往上/往下滑多选节点，按Ctrl键可以多选间隔的节点

4、快捷键：
- enter创建新节点、tab / shift+tab缩进/取消缩进
- ctrl+enter 进入任务，再按一次就完成，完成后节点下方的节点会变灰色
- ctrl+shift+方向键上/下，移动节点
- 按alt+方向键上/下聚焦模式
- shift+enter节点内换行
- ctrl+backspace 清空节点内容
- Ctrl+Shift+Backspace 删除当前节点

## v1.1：
1、非`- `开头的数据处理，目前是调用obsidian API markdownrenderer直接渲染出来显示，内容仅可读，不可编辑

2、支持双链面板跳转，左上角前进返回

## v1.2：
1、实时预览（类似logseq）

2、插件可以配置：源码模式（之前的功能）、实时预览模式

## v1.3：
修复：

1、Live Preview 模式下 Backspace 无法删除整个节点的问题

2、Live Preview 模式和源码模式存在拖拽节点后，垂直线未能正确渲染问题

3、修复内存泄漏问题，改善性能

## v1.4：
修复：

1、子节点未能跟随父级节点TAB、SHIFT+TAB

2、多选节点TAB、SHIFT+TAB，未能跟随层级

3、TAB键缩进逻辑错误

4、修复多选节点TAB、SHIFT+TAB键缩进逻辑错误

5、源码模式和Live Preview模式，Enter键闪烁问题（重渲染）

6、Live Preview编辑层按住鼠标左键上下拖拽选节点导致节点全选，限定显示层拖拽选多选节点

7、源码模式和Live Preview模式下编辑节点视口/滚动位置跳动

8、操作节点的Console错误

9、保存初始状态作为撤销底线，止于从 Markdown 进入 Workflowy 视图时的初始状态，避免多次按Ctrl+Z进入构造函数中的空状态

## v1.5：
- 修复标签点击搜索、图片和双链`![[]]`的渲染
- 修复嵌入内容点击跳转，增加右上角点击跳转的双向箭头图标按钮
- 嵌入内容适配各类主题样式

## v1.6：
- 修复嵌入内容导致后续大纲节点垂直线渲染问题
- 异步嵌入（图片[含PDF++]/Dataview/Excalidraw/BASE/Canvas等）且内容未变的块，复用其DOM元素，避免异步嵌入重新加载导致的高度变化和页面闪烁
- 添加Excalidraw图片的双向箭头图标按钮，支持Excalidraw图片的双击事件处理
- 修复大纲节点以```开头代码块的缩进丢失问题
- 使用AbstractInputSuggest用于输入框双链输入[[]]的建议，含`#`和`^`块引用
- 优化拖拽事件处理，区分文本选择拖拽（当前节点内） vs 块拖拽（跨节点），阻止无效拖拽——当文本选择拖拽离开当前节点时
- 修复窗口resize、侧边栏展开/收起等重新渲染垂直线

## v1.7：

1、修复：
- Live Preview下编辑模式上下方向键无法使用问题（跳转上下的节点）
- 移除插件设置中冗余的快捷键命令（撤销、重做），以及不必要的默认快捷键配置，避免与原生Markdown及三方视图冲突

2、新增：
- 对于新的md打开的workflowy视图（如双链跳转），内容为空，添加类似zoom聚焦下的点击新增节点提示
- 对于统一md文件在Obsidian上下分屏、左右分屏，Markdown与workflowy视图编辑，内容双向实时更新，支持与Mindmap NextGen等三方插件联用
- 快捷键命令添加切换渲染模式:源码模式/Live Preview模式

## v1.8：

1、新增：
- 实现Workflowy视图中保存节点的折叠/展开状态功能，使用HTML 注释作为折叠标记完整标记，格式：<!--{marker}-->，默认为 <!--c-->
- 在Live Preview模式的节点编辑层（textarea）隐藏块引用ID，避免误编辑

2、修复：
- 块引用ID的折叠节点避免与折叠标记冲突，修正为折叠标记在块引用ID之前（<!--c--> ^blockid），以及块引用ID前空格丢失问题
- Live Preview模式块引用链接格式修正为[[文件名# ^blockid]]（# 丢失会导致无法跳转）
- 当节点使用 Shift+Enter 换行（多行内容）时，折叠标记 <!--c--> 没有被正确解析

## v1.9：

1、新增：
- 从剪贴板粘贴图片和Obsidian左侧栏文件列表拖拽图片至workflowy视图中，会显示![[XXXXXX.png]]
- 支持Obsidian 左侧栏文件列表和外部资源管理器（根据Obsidian设置中文件与链接配置来判断存放哪里的）拖拽文件至workflowy视图中，根据文件类型生成链接：.md 文件：[[filename]]其他文件：![[filename.ext]]
- Live Preview模式及源码模式拖拽文件增加光标指示
- workflowy视图下标题引用、块引用的双链跳转至对应页面位置，以及高亮效果显示

2、修复：
- 清理3组快捷键配置，从插件设置界面配置改为直接内置：删除当前块 (Ctrl+Shift+Backspace)、向上移动块 (Ctrl+Shift+↑)、向下移动块(Ctrl+Shift+↓)；
- 补充快捷键：清空当前节点内容（ctrl+backspace）

## v2.0：

1、新增：
- 类logseq快捷键及功能：shift+点击、ctrl悬浮、alt创建块引用
- 块跨文档鼠标左键（节点圆圈）单选与多选拖拽功能
- 块跨/本文档 Alt+鼠标左键（节点圆圈）拖拽功能自动创建块引用
- 前缀加`!`的标题引用、块引用的双链跳转至对应页面位置，以及高亮效果显示

2、修复：
- 删除当前块 (Ctrl+Shift+Backspace)快捷键光标位置问题（自动到前一节点末尾）

## v2.1：

1、新增：
- 添加移动工具栏按钮：待办、加粗、斜体、删除线、高亮、代码、取消缩进、缩进、回车、收键盘
- <img width="532" height="59" alt="image" src="https://github.com/user-attachments/assets/9e6b6e23-3ef0-422e-a57b-ac5c74c2fb5a" />
- 参考幕布移动端设计将折叠指示器放右侧，展开状态 ▼（向下），折叠状态 ◀（向左），并添加背景块且之间有间隔（不连续）

2、修复：
- 移动端无法使用桌面端圆圈节点样式（过大），使用::after 伪元素显示圆点
- 移动端节点折叠后，圆圈中心显示矩形方框问题
- 移动端垂直线未能对齐圆圈中心显示
- 解决三角形折叠指示器（▼）位于垂直线的左侧，造成视觉上错位问题

## v2.2:

1、优化：
- 有序列表自动排序
- 大纲视图下编辑的有序列表与markdown视图双向同步

2、修复：
- 有序列表自动被修改为无序列表
- 有序列表与节点内容间距太远问题
- Ctrl+Z、跨文档拖拽等操作丢失有序列表序号问题